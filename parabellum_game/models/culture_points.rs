use parabellum_types::common::Speed;

const MAX_VILLAGES: usize = 50;

/// required_cp[speed][village_count] -> CP cumulativi richiesti per avere `village_count` villaggi.
/// Indici validi: 0..=MAX_VILLAGES. (0 e 1 sono 0 per comoditÃ )
const REQUIRED_CP_X1: [u32; MAX_VILLAGES + 1] = [
    0, // 0
    0, // 1
    2000, 8000, 20000, 39000, 65000, 99000, 141000, 191000, 251000, 319000, 397000, 486000, 584000,
    692000, 811000, 941000, 1082000, 1234000, 1397000, 1572000, 1759000, 1957000, 2168000, 2391000,
    2627000, 2874000, 3135000, 3409000, 3695000, 3995000, 4308000, 4634000, 4974000, 5327000,
    5695000, 6076000, 6471000, 6881000, 7304000, 7742000, 8195000, 8662000, 9143000, 9640000,
    10151000, 10677000, 11219000, 11775000, 12347000,
];

const REQUIRED_CP_X2: [u32; MAX_VILLAGES + 1] = [
    0, 0, 800, 3900, 10000, 19400, 32400, 49300, 70300, 95500, 125300, 159600, 198700, 242800,
    291800, 346100, 405600, 470500, 540900, 616900, 698600, 786100, 879400, 978700, 1084100,
    1195600, 1313300, 1437200, 1567600, 1704300, 1847600, 1997400, 2153900, 2317000, 2487000,
    2663700, 2847400, 3038000, 3235600, 3440300, 3652100, 3871000, 4097300, 4330800, 4571600,
    4819800, 5075500, 5338700, 5609400, 5887700, 6173600,
];

const REQUIRED_CP_X3: [u32; MAX_VILLAGES + 1] = [
    0, 0, 500, 2600, 6700, 12900, 21600, 32900, 46900, 63700, 83500, 106400, 132500, 161900,
    194600, 230700, 270400, 313700, 360600, 411300, 465700, 524000, 586300, 652500, 722700, 797000,
    875500, 958200, 1045000, 1136200, 1231700, 1331600, 1435900, 1544700, 1658000, 1775800,
    1898300, 2025300, 2157100, 2293500, 2434700, 2580700, 2731500, 2887200, 3047700, 3213200,
    3383700, 3559100, 3739600, 3925100, 4115800,
];

const REQUIRED_CP_X5: [u32; MAX_VILLAGES + 1] = [
    0, 0, 300, 1600, 4000, 7800, 13000, 19700, 28100, 38200, 50100, 63800, 79500, 97100, 116700,
    138400, 162200, 188200, 216400, 246800, 279400, 314400, 351800, 391500, 433600, 478200, 525300,
    574900, 627000, 681700, 739000, 799000, 861600, 926800, 994800, 1065500, 1139000, 1215200,
    1294200, 1376100, 1460800, 1548400, 1638900, 1732300, 1828600, 1927900, 2030200, 2135500,
    2243800, 2355100, 2469500,
];

const REQUIRED_CP_X10: [u32; MAX_VILLAGES + 1] = [
    0, 0, 200, 800, 2000, 3900, 6500, 9900, 14100, 19100, 25100, 31900, 39700, 48600, 58400, 69200,
    81100, 94100, 108200, 123400, 139700, 157200, 175900, 195700, 216800, 239100, 262700, 287400,
    313500, 340900, 369500, 399500, 430800, 463400, 497400, 532700, 569500, 607600, 647100, 688100,
    730400, 774200, 819500, 866200, 914300, 964000, 1015100, 1067700, 1121900, 1177500, 1234700,
];

#[inline]
pub fn required_cp(speed: Speed, village_count: usize) -> u32 {
    let count = if village_count > MAX_VILLAGES {
        MAX_VILLAGES
    } else {
        village_count
    };
    let table = match speed {
        Speed::X1 => &REQUIRED_CP_X1,
        Speed::X2 => &REQUIRED_CP_X2,
        Speed::X3 => &REQUIRED_CP_X3,
        Speed::X5 => &REQUIRED_CP_X5,
        Speed::X10 => &REQUIRED_CP_X10,
    };
    table[count] as u32
}
